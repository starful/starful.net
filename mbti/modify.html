<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css">
    <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js"></script>
    <style type="text/css">
    form {
        margin: 5% 15% 5% 15%;
        width: 70%;
    }

    .modifyButton {
        width: 15%;
        height: 60px;
        border-radius: 6px 6px 6px 6px;
        background-color: #4b9dea;
        color: #fff;
        box-shadow: 0 0 10px rgb(102 179 251 / 50%);
        border-color: #4b9dea;
        font-size: x-large;
        margin: 0% 0% 0% 85%;
    }
    </style>
    <script type="text/javascript">
    $(document).ready(function() {

        kind = sessionStorage.getItem('kind');
        id = sessionStorage.getItem('id');
        data = { "kind": kind, "id": id };
        json = JSON.stringify(data);

        var target = '#result';
        var insert = '';

        $.ajax({
            type: "POST",
            url: "https://starful.net/api/mbti/getDetail",
            data: json,
            contentType: "application/json",
            success: function(datas) {
                console.log(datas);
                insert += ' '
                for (var i = 0; i < datas["datas"].length; i++) {
                    insert += ' <label>' + datas['datas'][i]["kind"] + '</label>'
                    insert += ' <label> | </label>'
                    insert += ' <label>' + datas['datas'][i]["reg_user"] + '</label>'
                    insert += ' <label> | </label>'
                    insert += ' <label> ' + datas['datas'][i]["reg_datetime"] + '</label>'
                    insert += ' <label> | </label>'
                    insert += ' <label> ' + datas['datas'][i]["update_datetime"] + '</label>'
                    insert += ' <label> | </label>'
                    insert += ' <label for=""> Comment </label>'
                    insert += ' <span class="badge badge-primary badge-pill">14</span>'
                }
                $(target).append(insert);
                $("#result").show();

                $("#title").val(datas['datas'][0]["title"]);
                $("#contents").val(datas['datas'][0]["contents"]);

            },
            error: function(msg) {
                console.log("error");
            }
        });
    });
    </script>
    <script>
        function send() {
		      kind = sessionStorage.getItem('kind');
		      id = sessionStorage.getItem('id');
		      title = $("#title").val()
		      contents = $("#contents").val()

		      data = {"kind": kind, "id": id, "title": title, "contents": contents};
		      json = JSON.stringify(data);

		      $.ajax({
		        type: "POST",
		        url: "https://starful.net/api/mbti/setDetail",
		        data: json,
		        contentType: "application/json",
		        success: function(datas) {
		        	window.location.href = "https://starful.net/mbti/detail.html"
		        },
		        error: function(msg) {
		          console.log("error");
		        }
		      });
			}
		</script>
</head>

<body>
    <form class="needs-validation" novalidate>
        <div id="result" class="form-group text-right">
        </div>
        <div class="form-group">
            <label for="exampleFormControlInput1">◆Title</label>
            <input type="text " class="form-control form-control-lg bg-white" id="title">
            <div class="valid-feedback">Looks good!</div>
        </div>
        <div class="form-group">
            <label for="exampleFormControlTextarea1">◆Contents</label>
            <textarea class="form-control bg-white" id="contents" rows="10"></textarea>
        </div>
        <button class="modifyButton" onclick="send()">send</button>
    </form>
</body>

</html>